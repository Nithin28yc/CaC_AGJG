name: SessionManagement
 
on:
  workflow_dispatch:

jobs:   
  job1:  
    name: Account Locking for multiple failed attempts
    if: always()
    runs-on: ubuntu-latest
    steps: 
    - name: Build
      run: sleep 10
      
  job2:  
    needs: job1
    name: Cookie timeout
    if: always()
    runs-on: ubuntu-latest
    steps: 
    - name: Build
      run: sleep 9
    
  job3:  
    name: Unsecure session check  
    if: always()
    needs: job2
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Build with Mavev
      run: |
        cd Compliance_Check
        mvn test -DappURL="${{ secrets.APPURL }}" -Dusername="${{ secrets.USERNAME }}" -Dpassword="${{ secrets.PASSWORD }}" -DsuiteXmlFile=SessionManagement.xml
        cd `pwd`/test-output/TestReport
        ls
    - name: Upload report to artifact
      if: always()
      uses: actions/upload-artifact@v3
      with:
        name: SessionManagementReport
        path: ${{ github.workspace }}/Compliance_Check/test-output/TestReport/LatestTestReport
        
  job4:  
    needs: job3
    name: Concurrent session
    if: always()
    runs-on: ubuntu-latest
    steps: 
    - name: Build
      run: sleep 9
      
  job5:  
    needs: job4
    name: Session ID encryption
    if: always()
    runs-on: ubuntu-latest
    steps: 
    - name: Build
      run: sleep 10
      
  job6:  
    needs: job5
    name: New session id for logins
    if: always()
    runs-on: ubuntu-latest
    steps: 
    - name: Build
      run: sleep 9
